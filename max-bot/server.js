const express = require('express');
const app = express();
app.use(express.json());

const BOT_TOKEN = "f9LHodD0cOJKZpS4mwl-etS2LBy2AT6YNLTnE4MNr4DIymGKEXo1Xc9v1m05q7zS_eci41H2P8Mp8MaFuzpt";

// ะะฑัะฐะฑะพััะธะบ ะฒะตะฑััะบะพะฒ
app.post('/webhook', async (req, res) => {
    console.log('๐จ ะะพะปััะตะฝ ะฒะตะฑััะบ:', req.body.update_type);
    
    try {
        const update = req.body;
        
        if (update.update_type === 'message_created') {
            const message = update.message;
            const text = message.body.text.toLowerCase();
            
            let responseText = '';
            
            if (text.includes('ะฟัะธะฒะตั') || text.includes('start') || text.includes('/start')) {
                responseText = `ะัะธะฒะตั! ะฏ ะฑะพั ะะฝัะพะัะปัั! ๐ฐ

ะฏ ะฟะพะผะพะณะฐั ะฝะฐัะพะดะธัั ัะพัะธะฐะปัะฝะพ ะทะฝะฐัะธะผัะต ะฝะพะฒะพััะธ ะธ ะฒะพะทะผะพะถะฝะพััะธ ะดะปั ััะฐััะธั.

๐น **ะงัะพ ั ัะผะตั:**
โข ะะตััะพะฝะฐะปะธะทะธัะพะฒะฐะฝะฝะฐั ะปะตะฝัะฐ ะฝะพะฒะพััะตะน
โข ะะพะฒะพััะธ ะฟะพ ัะบะพะปะพะณะธะธ, ะฑะปะฐะณะพัะฒะพัะธัะตะปัะฝะพััะธ, ะธะฝะบะปัะทะธะฒะฝะพััะธ
โข ะััะผัะต ัััะปะบะธ ะดะปั ะฟะพะผะพัะธ

๐น **ะะพะผะฐะฝะดั:**
"ะฝะพะฒะพััะธ" - ะฟะพะบะฐะทะฐัั ะฟะพัะปะตะดะฝะธะต ะฝะพะฒะพััะธ
"ะบะฐัะตะณะพัะธะธ" - ะฒัะฑัะฐัั ะธะฝัะตัะตัั
"ะฟะพะผะพัั" - ัะฟัะฐะฒะบะฐ

ะัะบัะพะนัะต ะผะธะฝะธ-ะฟัะธะปะพะถะตะฝะธะต ะดะปั ะฟะพะปะฝะพะณะพ ะดะพัััะฟะฐ!`;
            } 
            else if (text.includes('ะฝะพะฒะพััะธ') || text.includes('news')) {
                responseText = `๐ **ะะพัะปะตะดะฝะธะต ะฝะพะฒะพััะธ:**

๐ฑ *ะญะบะพะปะพะณะธั*
โข ะะพะปะพะฝัะตัั ะพัะธััะธะปะธ 5 ะบะผ ะฑะตัะตะณะฐ ะะฐะนะบะฐะปะฐ
โข ะะฐะฟััะตะฝ ะฝะพะฒัะน ะฟัะพะตะบั ะฟะพ ะฟะตัะตัะฐะฑะพัะบะต ะฟะปะฐััะธะบะฐ

โค๏ธ *ะะปะฐะณะพัะฒะพัะธัะตะปัะฝะพััั* 
โข ะกะฑะพั ััะตะดััะฒ ะดะปั ะดะตััะบะพะณะพ ะดะพะผะฐ ะทะฐะฒะตััะตะฝ ะฝะฐ 80%
โข ะะปะฐะณะพัะฒะพัะธัะตะปัะฝัะน ะทะฐะฑะตะณ ัะพะฑัะฐะป 500+ ััะฐััะฝะธะบะพะฒ

โฟ *ะะฝะบะปัะทะธะฒะฝะพััั*
โข ะัะบัััะฐ ะดะพัััะฟะฝะฐั ััะตะดะฐ ะฒ ัะตะฝััะฐะปัะฝะพะผ ะฟะฐัะบะต
โข ะะฝะบะปัะทะธะฒะฝัะน ัะตะฐัั ะฟัะตะดััะฐะฒะธะป ะฝะพะฒัะน ัะฟะตะบัะฐะบะปั

๐ป *ะฆะธััะพะฒะพะต ะฟัะพัะฒะตัะตะฝะธะต*
โข ะะตัะฟะปะฐัะฝัะต ะบัััั ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธั ะดะปั ะฟะพะดัะพััะบะพะฒ
โข ะฆะธััะพะฒะฐั ะณัะฐะผะพัะฝะพััั ะดะปั ััะฐััะตะณะพ ะฟะพะบะพะปะตะฝะธั

*ะัะบัะพะนัะต ะผะธะฝะธ-ะฟัะธะปะพะถะตะฝะธะต ะดะปั ะฟะตััะพะฝะฐะปะธะทะธัะพะฒะฐะฝะฝะพะน ะปะตะฝัั!*`;
            }
            else if (text.includes('ะบะฐัะตะณะพัะธะธ') || text.includes('ะธะฝัะตัะตัั')) {
                responseText = `๐ฏ **ะะพัััะฟะฝัะต ะบะฐัะตะณะพัะธะธ:**

๐ฑ ะญะบะพะปะพะณะธั - ะทะฐัะธัะฐ ะพะบััะถะฐััะตะน ััะตะดั
โค๏ธ ะะปะฐะณะพัะฒะพัะธัะตะปัะฝะพััั - ะฟะพะผะพัั ะฝัะถะดะฐััะธะผัั  
โฟ ะะฝะบะปัะทะธะฒะฝะพััั - ัะฐะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ ะดะปั ะฒัะตั
๐ป ะฆะธััะพะฒะพะต ะฟัะพัะฒะตัะตะฝะธะต - ัะตัะฝะพะปะพะณะธะธ ะธ ะพะฑัะฐะทะพะฒะฐะฝะธะต

*ะัะฑะตัะธัะต ะดะพ 3 ะบะฐัะตะณะพัะธะน ะฒ ะผะธะฝะธ-ะฟัะธะปะพะถะตะฝะธะธ!*`;
            }
            else if (text.includes('ะฟะพะผะพัั') || text.includes('help')) {
                responseText = `๐ **ะะพะผะพัั ะฟะพ ะฑะพัั ะะฝัะพะัะปัั**

๐น *ะัะฝะพะฒะฝัะต ะบะพะผะฐะฝะดั:*
"ะฟัะธะฒะตั" / "start" - ะฝะฐัะฐัั ัะฐะฑะพัั
"ะฝะพะฒะพััะธ" - ะฟะพะบะฐะทะฐัั ะฟะพัะปะตะดะฝะธะต ะฝะพะฒะพััะธ  
"ะบะฐัะตะณะพัะธะธ" - ัะฟะธัะพะบ ะบะฐัะตะณะพัะธะน
"ะฟะพะผะพัั" - ััะฐ ัะฟัะฐะฒะบะฐ

๐น *ะะธะฝะธ-ะฟัะธะปะพะถะตะฝะธะต:*
ะัะบัะพะนัะต ะผะธะฝะธ-ะฟัะธะปะพะถะตะฝะธะต ะดะปั:
โข ะะตััะพะฝะฐะปะธะทะธัะพะฒะฐะฝะฝะพะน ะปะตะฝัั ะฝะพะฒะพััะตะน
โข ะัะฑะพัะฐ ะธะฝัะตัะตััััะธั ะบะฐัะตะณะพัะธะน
โข ะััะผัั ัััะปะพะบ ะดะปั ััะฐััะธั ะฒ ะฟัะพะตะบัะฐั
โข ะะพะธัะบะฐ ะธ ัะธะปัััะฐัะธะธ ะฝะพะฒะพััะตะน

๐น *ะะฐัะตะณะพัะธะธ ะฝะพะฒะพััะตะน:*
ะญะบะพะปะพะณะธั, ะะปะฐะณะพัะฒะพัะธัะตะปัะฝะพััั, ะะฝะบะปัะทะธะฒะฝะพััั, ะฆะธััะพะฒะพะต ะฟัะพัะฒะตัะตะฝะธะต`;
            }
            else {
                responseText = `ะฏ ะฟะพะฝัะป ะฒะฐั ะทะฐะฟัะพั! ๐ค

ะะพะฟัะพะฑัะนัะต ะพะดะฝั ะธะท ะบะพะผะฐะฝะด:
โข "ะะพะฒะพััะธ" - ะฐะบััะฐะปัะฝัะต ัะพะฑััะธั
โข "ะะฐัะตะณะพัะธะธ" - ะฒัะฑะพั ะธะฝัะตัะตัะพะฒ  
โข "ะะพะผะพัั" - ะฟะพะดัะพะฑะฝะฐั ัะฟัะฐะฒะบะฐ

ะะปะธ ะพัะบัะพะนัะต ะผะธะฝะธ-ะฟัะธะปะพะถะตะฝะธะต ะดะปั ะฟะพะปะฝะพะณะพ ััะฝะบัะธะพะฝะฐะปะฐ ั ะฟะตััะพะฝะฐะปะธะทะธัะพะฒะฐะฝะฝะพะน ะปะตะฝัะพะน! ๐ฑ`;
            }
            
            // ะัะฟัะฐะฒะปัะตะผ ะพัะฒะตั
            const response = await fetch('https://platform-api.max.ru/messages', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': BOT_TOKEN
                },
                body: JSON.stringify({
                    chat_id: message.recipient.chat_id,
                    text: responseText,
                    format: "markdown"
                })
            });
            
            console.log('โ ะัะฒะตั ะพัะฟัะฐะฒะปะตะฝ');
        }
        
        res.status(200).send('OK');
    } catch (error) {
        console.error('โ ะัะธะฑะบะฐ ะฒะตะฑััะบะฐ:', error);
        res.status(500).send('Error');
    }
});

// ะกัะฐััะพะฒะฐั ัััะฐะฝะธัะฐ
app.get('/', (req, res) => {
    res.send('๐ค ะะพั ะะฝัะพะัะปัั ะฐะบัะธะฒะตะฝ!');
});

const PORT = 3001;
app.listen(PORT, () => {
    console.log(`๐ ะะพั ัะตัะฒะตั ะทะฐะฟััะตะฝ ะฝะฐ ะฟะพััั ${PORT}`);
});